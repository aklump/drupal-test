<!DOCTYPE html>

<html>
<head>
  <title>End to End Testing</title>
  <link href="search/tipuesearch.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
</head>

<body class="page--end-to-end">
<header>
  <div class="pager"><a href="client.html" class="prev client">&laquo;Client Tests</a><a href="index.html" class="index pager__book-title">Drupal Test</a><a href="manual.html" class="next manual">Add Manual Tests&raquo;</a></div></header>
<section class="sub-header">
  <div class="breadcrumbs"><a href="index.html">Index</a>
         &raquo
                        <a href="README.html">Using Drupal Test</a>
         &raquo
      </div>      <div class="search__wrapper">
  <form action="search--results.html">
    <input type="text" class="search-input" name="q" id="tipue_search_input" autocomplete="off" required>
  </form>
</div>
  </section>


<h1>End to End Testing</h1>

<section>

<blockquote>
  <p>End-to-end testing is a Software testing methodology to test an application flow from start to end. The purpose of end to end testing is to simulate the real user scenario and validate the system under test and its components for integration and data integrity.</p>
</blockquote>

<p>Create these tests by extending <code>\AKlump\DrupalTest\EndToEndTestBase</code>.  They should be saved in your <em>Client</em> folders.</p>

<p>These tests are the slowest as they offer a full browser environment, so they facilitate the testing of forms, multi-page workflows, and Javascript interaction.  If you just want to check for elements on a single page, use <code>\AKlump\DrupalTest\ClientTestBase</code> instead.</p>

<p>These tests use <a href="http://mink.behat.org/en/latest/index.html">Mink</a> and <a href="https://www.seleniumhq.org">Selenium</a> to have a fully controllable browser, but <strong>run against a real site in it's active state.</strong>  These should be used when you wish to interact at the Browser level with a website in it's current state, just as you would as a human running manual tests.</p>

<blockquote>
  <p>These are not the same as <a href="https://www.drupal.org/docs/8/phpunit/phpunit-browser-test-tutorial">Drupal 8's Browser Tests</a> because: "Browser tests create a complete Drupal installation and a virtual web browser and then use the virtual web browser to walk the Drupal install through a series of tests, just like you would do if you were doing it by hand."</p>
  
  <p><strong>These tests DO NOT create a complete Drupal installation.</strong></p>
</blockquote>

<h2>Installation</h2>

<ol>
<li>You must have a running selenium server to use these tests.</li>
</ol>

<h3>Installing Selenium Standalone Server</h3>

<p>This should be as simple as downloading a file, and starting a Java process on that file.  Follow these steps:</p>

<ol>
<li>Download from <a href="https://www.seleniumhq.org/download/">this page</a>; the link should be at the top.  This needs to happen just once.  Place it in a logical location on your system, maybe your home folder.</li>
<li><p>Create a shortcut script <em>./bin/selenium.sh</em> to launch your Selenium server with contents like this, adjusted for your situation.</p>

<pre><code>#!/usr/bin/env bash
java -jar /Users/aklump/selenium/selenium-server-standalone-3.141.59.jar  -host 127.0.0.1 -port 4444
</code></pre></li>
<li>Make that script executable <code>chmod u+x ./bin/selenium.sh</code></li>
<li><p>Start your server in a new terminal window:</p>

<pre><code>cd {path to this lib}
./bin/selenium.sh
</code></pre></li>
<li><p>Verify it's running by visiting: <a href="http://127.0.0.1:4444/wd/hub/static/resource/hub.html">http://127.0.0.1:4444/wd/hub/static/resource/hub.html</a></p></li>
</ol>

<h2>Organizing Tests</h2>

<ol>
<li>Think of a single test class as one end-to-end scenario.</li>
<li>Have lots of shorter test classes.</li>
<li>Break each scenario (class) into small units, as test methods.</li>
<li>Keep test methods small and named very discriptively.</li>
</ol>

<h2>Annotations</h2>

<ol>
<li>Give the test class a summary such as <em>User is able to login...</em></li>
<li>If the test modifies the database in any way mark the class <code>@destructive</code>.</li>
<li><p>Make test method names very descriptive so they can be parsed: <em>testLoggedInUserCanAccessUserSettingsPage</em></p>

<p>&lt;?php</p>

<p>namespace Drupal\Tests\gop;</p>

<p>/**</p>

<ul>
<li>User is able to login, change password, logout and login with new password.</li>
<li></li>
<li><p>@destructive
*/
class UserCanChangePasswordEndToEndTest extends EndToEndTestBase {</p>

<p>public function testLoggedInUserCanAccessUserSettingsPage() {
...</p></li>
</ul></li>
</ol>

<p>#</p>

<h2>Using Mink's <code>WebAssert</code></h2>

<ol>
<li><p>All of the methods of <code>\Behat\Mink\WebAssert</code> are available in your test methods through the use of <code>::assert()</code>, e.g.</p>

<pre><code>public function testPageTextOnHomepage() {
  $this-&gt;loadPageByUrl('/');

  // This is a method from \Behat\Mink\WebAssert that has been made available by \AKlump\DrupalTest\EndToEndTestBase
  $this-&gt;assert()-&gt;pageTextContains('Welcome to My Website');
}
</code></pre></li>
<li><p><code>::assert()</code> returns you a wrapper around \Behat\Mink\WebAssert that handles assertion tallies and failure exceptions normally throw by \Behat\Mink\WebAssert in a way native to PhpUnit.</p></li>
<li><p>There is some duplication with certain shorthand and common assertions, for example take these two examples of the same assertion.  The first one has an opinion that all elements should be searched using a CSS selector, so there's less typing, however the second is more powerful, and in fact necessary if you want to assert using XPath.</p>

<pre><code>$this-&gt;assertElementExists('.t-trigger-account-dropdown');
$this-&gt;assert()-&gt;elementExists('css', '.t-trigger-account-dropdown');
</code></pre></li>
</ol>
</section>

<div class="search__results">
  <div id="tipue_search_content"></div>
</div>

<footer>
  <div class="pager"><a href="client.html" class="prev client">&laquo;Client Tests</a><a href="index.html" class="index pager__book-title">Drupal Test</a><a href="manual.html" class="next manual">Add Manual Tests&raquo;</a></div>  
  <div id="footer-legaleeze">
    <p class="legaleeze center">Version: 0.4.5 &bull; Last Updated: Sun, 07 Apr 2019 15:50:24 -0700</p>
  </div>
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="search/tipuesearch_content.js"></script>
  <script src="search/tipuesearch_set.js"></script>
  <script src="search/tipuesearch.min.js"></script>
  <script>
    $(document).ready(function() {
      $('#tipue_search_input').tipuesearch()
    })
  </script>
<script src="js/core.js"></script>
</body>
</html>

