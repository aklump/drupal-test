<!DOCTYPE html>

<html>
<head>
  <title>Module and Theme Testing</title>
  <link href="search/tipuesearch.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
</head>

<body class="page--modules">
<header>
  <div class="pager">
  <a href="README.html" class="prev README">&laquo;Drupal Test</a>
  <a href="index.html" class="index">Index</a>
  <a href="unit.html" class="next unit">Unit Tests        &raquo;</a>
</div>
</header>

  <div class="search__wrapper">
  <form action="search--results.html">
    <input type="text" class="search-input" name="q" id="tipue_search_input" autocomplete="off" required>
  </form>
</div>

  <h1>Module and Theme Testing</h1>
  <div class="breadcrumb"><a href="index.html">Index</a></div>

<section>

<h2>Quick Start</h2>

<ol>
<li>Create <em>composer.json</em> in the module ensuring it will autoload the module's classes that will be tested.  This file may have nothing to do with Drupal, but it is used by the test runner's unit testing strategy.</li>
<li>Add the path to the test runner's <em>composer.json</em>, and <a href="https://github.com/wikimedia/composer-merge-plugin#updating-sub-levels-composerjson-files">you must call</a> <code>composer update --lock</code> on the test runner for dependencies to be installed for the test runner.</li>
<li>Add one or more tests to the module.</li>
</ol>

<h2>Test File Structure</h2>

<p>Each module or theme provides tests relative to it's own root directory.  Following this convention allows the test runner to auto-discover these tests.  e.g.,</p>

<pre><code>.
└── tests
    ├── jsonschema
    │   └── story_resource.json
    └── src
        ├── Client
        │   ├── Service
        │   │   └── EarthriseServiceClientTest.php
        ├── Kernel
        │   ├── Service
        │   │   ├── BreakpointServiceKernelTest.php
        │   └── TransformKernelTest.php
        ├── TestBase.php
        └── Unit
            ├── Service
            │   └── EarthriseServiceUnitTest.php
            └── TransformUnitTest.php
</code></pre>

<h2>Add the Module's <em>composer.json</em></h2>

<p>For a module to be unit testable it must have a <em>composer.json</em> file, which autoloads it's classes, the path of which <strong>must be added to this project's <em>composer.json</em> file</strong>, in the section <code>extra.merge-plugin.require</code>.  This is how the unit tests are able to autoload classes without bootstrapping Drupal, e.g.,</p>

<pre><code>    "extra": {
        "merge-plugin": {
            "require": [
                "../web/sites/all/modules/custom/gop3_core/composer.json"
            ]
        }
    }
</code></pre>

<h2>Must Test Classes Test a Single Class?</h2>

<p>Unit and Kernel tests do not have to test a single class, for example if you are writing a test to cover theme functions.  In order to make this happen you have to do the following in your test class:</p>

<pre><code>    class Gop5ThemeKernelTest extends KernelTestBase {

      protected $schema = [

        // By setting this to false, we indicate we are not testing a class.
        'classToBeTested' =&gt; FALSE,
      ];

    ...
</code></pre>
</section>

<div class="search__results">
  <div id="tipue_search_content"></div>
</div>

<footer>
  <div class="pager">
  <a href="README.html" class="prev README">&laquo;Drupal Test</a>
  <a href="index.html" class="index">Index</a>
  <a href="unit.html" class="next unit">Unit Tests        &raquo;</a>
</div>
  
  <div id="footer-legaleeze">
    <p class="legaleeze center">Version: 0.0.1 &bull; Last Updated: Sun, 18 Nov 2018 16:04:29 -0800</p>
  </div>
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="search/tipuesearch_content.js"></script>
  <script src="search/tipuesearch_set.js"></script>
  <script src="search/tipuesearch.min.js"></script>
  <script>
    $(document).ready(function () {
      $('#tipue_search_input').tipuesearch();
    });
  </script>
<script src="js/core.js"></script>
</body>
</html>

